<!DOCTYPE html> <html lang="EN"> <head> <meta charset="utf-8"> <title>Harmony</title> <style>html body{margin:0 auto 0 auto;padding:20px;max-width:1024px;font-family:sans-serif;font-size:14pt;overflow-y:scroll;}html body a{text-decoration:none;}html body a[href]{color:#0055AA;}html body a[href]:hover{color:#0088EE;}html body pre{background:#FAFAFA;border:1px solid #DDDDDD;padding:0.75em;overflow-x:auto;}html body pre >code a[href]{color:#223388;}article.project h1{font-size:1.7em;}article.project h1,article.project h2,article.project h3,article.project h4,article.project h5,article.project h6{margin:0.2em 0 0.1em 0;text-indent:1em;}article.project >header{text-align:center;}article.project >header img.logo{display:block;margin:auto;max-height:170px;}article.project >header h1{display:inline-block;text-indent:0;font-size:2.5em;}article.project >header .version{vertical-align:bottom;}article.project >header .languages{margin-top:-0.5em;text-transform:capitalize;}article.project >header .description{margin:0;}article.project >header .pages{margin-top:0.5em;font-size:1.2em;text-transform:capitalize;}article.project >header .pages a{display:inline-block;padding:0 0.2em;}article.project >section{margin:1em 0 1em 0;}article.project #index >ul{list-style:none;margin:0;padding:0;}article.project .row label{display:inline-block;min-width:8em;}article.project #system .row{display:flex;}article.project #system #dependencies{display:inline;margin:0;padding:0;}article.project #system #dependencies li{display:inline;padding:0 0.2em;}article.definition{margin:1em 0 0 0;}article.definition >header h1,article.definition >header h2,article.definition >header h3,article.definition >header h4,article.definition >header h5,article.definition >header h6{text-indent:0;display:inline-block;}article.definition >header ul{display:inline-block;list-style:none;margin:0;padding:0;}article.definition >header ul li{display:inline-block;padding:0 0.2em 0 0;}article.definition >header .visibility{display:none;}article.definition >header .visibility,article.definition >header .type{text-transform:lowercase;}article.definition >header .source-link{visibility:hidden;float:right;}article.definition >header .source-link:after{visibility:visible;content:"[SRC]";}article.definition .docstring{margin:0 0 0 1em;}article.definition .docstring pre{font-size:0.8em;white-space:pre-wrap;}.definition.package >header ul.nicknames{display:inline-block;list-style:none;margin:0;padding:0 0 0 1em;}.definition.package >header ul.nicknames li{display:inline;}.definition.package >header ul.nicknames:before{content:"(";}.definition.package >header ul.nicknames:after{content:")";}.definition.package ul.definitions{margin:0;list-style:none;padding:0 0 0 0.5em;}.definition.callable >header .name:before,.definition.type >header .name:before{content:"(";font-weight:normal;}.definition.callable >header .arguments:after,.definition.type >header .arguments:after{content:")";}.definition.callable >header .arguments .arguments:before,.definition.type >header .arguments .arguments:before{content:"(";}.definition.callable >header .arguments .argument,.definition.type >header .arguments .argument{padding:0;}.definition.callable >header .arguments .argument.lambda-list-keyword,.definition.type >header .arguments .argument.lambda-list-keyword{color:#991155;}.definition li>mark{background:none;border-left:0.3em solid #0088EE;padding-left:0.3em;display:block;} </style> </head> <body> <article class="project"> <header>  <img class="logo" src="harmony-logo.png" alt="Logo">    <span class="version">2.0.0</span>    <p class="description">A common lisp sound server and sound processing library.</p>   </header> <section id="documentation"><article><h2 id="about harmony">About Harmony</h2><p>Harmony is a library that provides you with audio processing tools as well as an audio server to play back music, sfx, and so forth. It is most suited for use in a game engine, but may feasibly also used for more advanced things such as a DAW.</p><h2 id="quick start">Quick Start</h2><p>To get running with a usable setup in no time flat, simply load harmony, an appropriate drain extension from cl-mixed, and some extension to play a file:</p><code style="display:block" class="code-block" data-language="common lisp"><pre>(ql:quickload '(harmony cl-mixed-mpg123
                #+linux cl-mixed-pulse
                #+darwin cl-mixed-coreaudio
                #+windows cl-mixed-wasapi
                #+bsd cl-mixed-oss))</pre></code><p>Then start a server:</p><code style="display:block" class="code-block" data-language="common lisp"><pre>(<a href="#FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAYBE-START-SIMPLE-SERVER" class="xref">org.shirakumo.fraf.harmony:maybe-start-simple-server</a>)</pre></code><p>And we can play some stuff back:</p><code style="display:block" class="code-block" data-language="common lisp"><pre>(<a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3APLAY" class="xref">org.shirakumo.fraf.harmony:play</a> #p&quot;~/my-music.mp3&quot; :mixer :music)</pre></code><p>The returned <code><a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICE" class="xref">voice</a></code> instance can be controlled with functions like <code><a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASTOP" class="xref">stop</a></code> and <code><a href="https://Shirakumo.github.io/cl-mixed/#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.MIXED%3AVOLUME" class="xref">mixed:volume</a></code>. Please see the documentation of the <code><a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICE" class="xref">voice</a></code> class for more hints on possible interactions. For one more quick illustration of Harmony's capabilities, let's restart the playback, but now with a lowpass filter applied:</p><code style="display:block" class="code-block" data-language="common lisp"><pre>(<a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASTOP" class="xref">org.shirakumo.fraf.harmony:stop</a> <a href="http://l1sp.org/cl/%2A" class="xref">*</a>)
(<a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3APLAY" class="xref">org.shirakumo.fraf.harmony:play</a> #p&quot;~/my-music.mp3&quot; :mixer :music :effects '((mixed:biquad-filter :filter :lowpass :frequency 400)))</pre></code><p>There's a lot more that can be done, such as chaining multiple filters, controlling the amount of mixers, applying effects to entire mixers, looping playback, horizontal mixing, and more.</p><h2 id="environments">Environments</h2><p>Environments are a way to handle music environments and horizontal mixing. To define a horizontal mixing environment, simply create an <code><a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AENVIRONMENT" class="xref">environment</a></code> instance, passing the desired environment sets as <code>:sets</code>:</p><code style="display:block" class="code-block" data-language="common lisp"><pre>(<a href="http://l1sp.org/cl/make-instance" class="xref">make-instance</a> <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AENVIRONMENT" class="xref">'org.shirakumo.fraf.harmony:environment</a>
  :sets '((:normal #p&quot;normal-track.mp3&quot; #p&quot;normal-track-calm&quot;)
          (:intense #p&quot;intense-track.mp3&quot;)))</pre></code><p>This defines an environment with two sets, <code>:normal</code> and <code>:intense</code>. When the normal set is playing, it will loop through <code>normal-track</code> and <code>normal-track-calm</code>. When the intense set is playing, it will loop through <code>intense-track</code>.</p><p>You can activate a set by using <code><a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATRANSITION" class="xref">transition</a></code>:</p><code style="display:block" class="code-block" data-language="common lisp"><pre>(<a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATRANSITION" class="xref">org.shirakumo.fraf.harmony:transition</a> <a href="http://l1sp.org/cl/%2A" class="xref">*</a> :normal)
(<a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATRANSITION" class="xref">org.shirakumo.fraf.harmony:transition</a> <a href="http://l1sp.org/cl/%2A%2A" class="xref">**</a> :intense :in 10.0)</pre></code><p>If you'd like more fine-grained control over the segments that are being played back, you can also manually construct <code><a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMUSIC-SEGMENT" class="xref">music-segment</a></code> instances and use the <code><a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATRANSITION" class="xref">transition</a></code> function to fade between <code><a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMUSIC-SEGMENT" class="xref">music-segment</a></code>s or change their volumes.</p><h2 id="also see">Also See</h2><ul><li><p><a class="external-link" href="https://shirakumo.github.io/cl-mixed">cl-mixed</a> For the mixing and sound processing library.</p></li></ul></article></section>   <section id="system"> <h2>System Information</h2>  <div class="row"> <label for="version">Version:</label> <a id="version">2.0.0</a> </div>   <div class="row"> <label for="dependencies">Dependencies:</label> <ul id="dependencies"><li><a class="external">trivial-features</a></li><li><a class="external" href="https://Shirakumo.github.io/cl-mixed/">cl-mixed</a></li><li><a class="external" href="https://shinmera.github.io/atomics/">atomics</a></li><li><a class="external">bordeaux-threads</a></li><li><a class="external">stealth-mixin</a></li><li><a class="external" href="https://Shirakumo.github.io/cl-mixed/">cl-mixed-alsa</a></li><li><a class="external" href="https://Shirakumo.github.io/cl-mixed/">cl-mixed-pulse</a></li></ul> </div>   <div class="row"> <label for="author">Author:</label> <a id="author" href="mailto:shinmera@tymoon.eu">Nicolas Hafner</a> </div>   <div class="row"> <label for="license">License:</label> <a id="license" href="https://github.com/Shirakumo/harmony/blob/master/LICENSE">zlib</a> </div>   <div class="row"> <label for="homepage">Homepage:</label> <a id="homepage" href="https://Shirakumo.github.io/harmony/">https://Shirakumo.github.io/harmony/</a> </div>   <div class="row"> <label for="sources">Sources:</label> <a id="sources" href="https://github.com/Shirakumo/harmony.git">https://github.com/Shirakumo/harmony.git</a> </div>  </section>    <section id="index"> <h2>Definition Index</h2> <ul> <li> <article class="definition package" id="PACKAGE ORG.SHIRAKUMO.FRAF.HARMONY"> <header> <h3> <a href="#PACKAGE%20ORG.SHIRAKUMO.FRAF.HARMONY">ORG.SHIRAKUMO.FRAF.HARMONY</a> </h3> <ul class="nicknames"></ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> <ul class="definitions"> <li> <article class="definition special-variable" id="VARIABLE ORG.SHIRAKUMO.FRAF.HARMONY:*SERVER*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%2ASERVER%2A">*SERVER*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/server.lisp#L11">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition class" id="CLASS ORG.SHIRAKUMO.FRAF.HARMONY:BUFFER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ABUFFER">BUFFER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/segment.lisp#L9">Source</a>  </header> <div class="docstring"><pre>Superclass for MIXED:BIP-BUFFER.

Keeps track of connected segments.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AFROM" class="xref">FROM</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AFROM-LOCATION" class="xref">FROM-LOCATION</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATO" class="xref">TO</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATO-LOCATION" class="xref">TO-LOCATION</a>
See MIXED:BIP-BUFFER</pre></div> </article> </li>  <li> <article class="definition class" id="CLASS ORG.SHIRAKUMO.FRAF.HARMONY:ENVIRONMENT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AENVIRONMENT">ENVIRONMENT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/environment.lisp#L11">Source</a>  </header> <div class="docstring"><pre>Encapsulates a playback environment.

An environment is used for horizontal mixing and contains a set of
track lists. The environment controls playback of the segments within
the track lists by ensuring that play heads are synchronised when
switching and allowing smooth transitioning between segments.

When initialising an environment, you may pass a :SETS argument, which
should be a list of the following structure:

  SETS ::= (SET*)
  SET  ::= (name SOURCE*)
  SOURCE ::= input | (input INITARGS*)

Where input and initargs are sutable for use with CREATE. The name
given names the state in which the environment must be for the
associated list of sources to be played back. The class used to create
is a MUSIC-SEGMENT.

The environment will continuously loop the current list of tracks
smoothly until it transitions to another state.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASTATE" class="xref">STATE</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AACTIVE-P" class="xref">ACTIVE-P</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATRANSITION" class="xref">TRANSITION</a>
See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMUSIC-SEGMENT" class="xref">MUSIC-SEGMENT</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS ORG.SHIRAKUMO.FRAF.HARMONY:MUSIC-SEGMENT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMUSIC-SEGMENT">MUSIC-SEGMENT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/environment.lisp#L101">Source</a>  </header> <div class="docstring"><pre>Subclass of VOICE that allows smooth transitions.

When initialised, takes the following initargs:

  :TRANSITION-POINTS
    A sequence of sample points at which a transition is considered to
    be favourable. If transition points are defined, the transition
    will be delayed until a transition point is hit. Otherwise, the
    transition will happen immediately.

  :TRANSITION-INTERVAL
  :TRANSITION-OFFSET
    Combined with :TRANSITION-OFFSET, defines the set of sample points
    where a transition is favourable. You may use this instead of
    :TRANSITION-POINTS if the points are always equidistant.
    Meaning, if (SAMPLE - TRANSITION-OFFSET % TRANSITION-INTERVAL) = 0
    a transition point is generated.

  :TRANSITION-FUN
    Instead of the above methods, you may also specify a manual
    function of two arguments, OLD and NEW sample indices, and returns
    a boolean indicating whether a transition may occur between OLD
    and NEW.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATRANSITION" class="xref">TRANSITION</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AENVIRONMENT" class="xref">ENVIRONMENT</a>
See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICE" class="xref">VOICE</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS ORG.SHIRAKUMO.FRAF.HARMONY:SEGMENT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASEGMENT">SEGMENT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/segment.lisp#L19">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition class" id="CLASS ORG.SHIRAKUMO.FRAF.HARMONY:SERVER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER">SERVER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/server.lisp#L13">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition class" id="CLASS ORG.SHIRAKUMO.FRAF.HARMONY:SOURCE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASOURCE">SOURCE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/segment.lisp#L115">Source</a>  </header> <div class="docstring"><pre>Superclass for MIXED:SOURCE

Includes extra information to allow for looping and handling of input
termination.

When initialised, takes the following initargs:

   :REPEAT
     How many times to repeat the source's output. On each repeat, the
     source is seeked to the :REPEAT-START. Instead of an integer, may
     also be NIL for no repeats (default), or T for endless repeats.
     
   :REPEAT-START
     The second (!) timestamp to which the source should be seeked
     once its end is reached. Defaults to 0.0
     
   :ON-END
     A function to be called once the source reaches its end. An end
     here means that the source has completed all repeats that were
     scheduled and has now run out of samples to output back. By
     default the source is disconnected from its outputs.
     
   :ON-FRAME-CHANGE
     A function to be called when the source's frame position is
     changed. By default does nothing.

See MIXED:SOURCE
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASEGMENT" class="xref">SEGMENT</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AREPEAT" class="xref">REPEAT</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AREPEAT-START" class="xref">REPEAT-START</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AON-END" class="xref">ON-END</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AON-FRAME-CHANGE" class="xref">ON-FRAME-CHANGE</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS ORG.SHIRAKUMO.FRAF.HARMONY:VOICE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICE">VOICE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/voice.lisp#L37">Source</a>  </header> <div class="docstring"><pre>Representation of a source, unpacker, and effects chain in one.

Accepts the following additional initargs on construction:

  :SOURCE
    Used to construct the source that's played back with this
    voice. See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAKE-SOURCE-FOR" class="xref">MAKE-SOURCE-FOR</a>

  :EFFECTS
    Designates a list of effects to be applied to the output of the
    source. See MAKE-SIMPLE-SERVER for a description of the syntax.

  :CHANNELS
    The number of output channels. Used to downmix or upmix the source
    to match with the required output.

  :ON-END
    This option is available to all SOURCEs, but has additionally
    recognised options for VOICES:
      :FREE
        FREE is called on the voice.
      :DISCONNECT
        The voice is disconnected, unhooked from the server, and
        the source seeked to the beginning.
      :CALL-TRACK-END
        TRACK-END is called on the voice and source.
    You may still pass a function, which will receive the VOICE as
    argument.

Note that the voice can be directly manipulated &quot;as expected&quot;
through most CL-MIXED functions. Wrapper methods exist that will defer
to the appropriate parts of the voice. Control of specific effects
still requires retrieving the effects instances (through SEGMENT) and
manually setting their parameters. However, even parameters on the
connected mixer, such as MAX-DISTANCE, may be set directly on the
voice for convenience.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASEGMENT" class="xref">SEGMENT</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASOURCE" class="xref">SOURCE</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATRACK-END" class="xref">TRACK-END</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAKE-SOURCE-FOR" class="xref">MAKE-SOURCE-FOR</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAKE-SOURCE-FOR-PATH-TYPE" class="xref">MAKE-SOURCE-FOR-PATH-TYPE</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASOURCE" class="xref">SOURCE</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASTOP" class="xref">STOP</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAKE-SIMPLE-SERVER" class="xref">MAKE-SIMPLE-SERVER</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMIXER" class="xref">MIXER</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ACONNECT" class="xref">CONNECT</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ADISCONNECT" class="xref">DISCONNECT</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AREPEAT" class="xref">REPEAT</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AACTIVE-P" class="xref">ACTIVE-P</a>
See MIXED:FREE
See MIXED:ADD
See MIXED:OUTPUTS
See MIXED:OUTPUT
See MIXED:DONE-P
See MIXED:MIN-DISTANCE
See MIXED:MAX-DISTANCE
See MIXED:ROLLOFF
See MIXED:LOCATION
See MIXED:VELOCITY
See MIXED:SEEK-TO-FRAME
See MIXED:SEEK
See MIXED:FRAME-POSITION
See MIXED:SAMPLERATE</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:ADD-TO"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AADD-TO">ADD-TO</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TARGET</li>    <li class="argument lambda-list-keyword">&amp;REST</li>    <li class="argument">PARTS</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/toolkit.lisp#L70">Source</a>  </header> <div class="docstring"><pre>Convenience function to quickly MIXED:ADD several instances.

See MIXED:ADD</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:CREATE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ACREATE">CREATE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SOURCE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>    <li class="argument">ARGS</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">NAME</li>    <li class="argument">CLASS</li>    <li class="argument">MIXER</li>    <li class="argument">SERVER</li>    <li class="argument">ON-END</li>    <li class="argument">VOLUME</li>    <li class="argument">IF-EXISTS</li>    <li class="argument lambda-list-keyword">&amp;ALLOW-OTHER-KEYS</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/simple.lisp#L145">Source</a>  </header> <div class="docstring"><pre>Creates a new voice to handle playback of a source.

CLASS should be a class designator for the voice to be constructed.

MIXER is used to ensure that the created voice has a matching channel
count to what is expected on the mixer.

IF-EXISTS may be

  NIL        --- NIL is returned.
  :IGNORE    --- The existing voice is returned.
  :ERROR     --- An error is signalled.
  :RESTART   --- The voice is seeked to the beginning.
  :STOP      --- The voice is stopped and returned.
  :SUPERSEDE
  :REPLACE   --- The existing voice is stopped, removed, and a new
                 voice created.

This option is only used if a source with the same name already exists
on the server.

Arguments other than NAME, CLASS, MIXER, SERVER, VOLUME, and
IF-EXISTS are passed on as initargs for the construction of the voice
(or whatever is supplied in CLASS).

Returns the constructed and started VOICE.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3APLAY" class="xref">PLAY</a>
See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICE" class="xref">VOICE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:DETECT-PLATFORM-DRAIN"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ADETECT-PLATFORM-DRAIN">DETECT-PLATFORM-DRAIN</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/simple.lisp#L31">Source</a>  </header> <div class="docstring"><pre>Returns the class name of the type of drain to use on this platform.

May return NIL if no suitable drains are present, though most likely
will simply return the dummy drain in that case.

This will *not* load any extra code, so it will only be able to try
out drain types that have been loaded in. It's up to you to load
modules you want to support.

See the cl-mixed extensions for supported systems.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:DOT-SERVER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ADOT-SERVER">DOT-SERVER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">SERVER</li>    <li class="argument">FILE</li>    <li class="argument">CONVERT</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/server.lisp#L258">Source</a>  </header> <div class="docstring"><pre>Produces a graphviz file describing the server's segment layout.

Useful for debugging. If CONVERT is passed, invokes `dot` on the
produced dotfile to render it to the requested image type.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:MAKE-SIMPLE-SERVER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAKE-SIMPLE-SERVER">MAKE-SIMPLE-SERVER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">NAME</li>    <li class="argument">SAMPLERATE</li>    <li class="argument">DRAIN</li>    <li class="argument">DEVICE</li>    <li class="argument">LATENCY</li>    <li class="argument">OUTPUT-CHANNELS</li>    <li class="argument">EFFECTS</li>    <li class="argument">MIXERS</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/simple.lisp#L72">Source</a>  </header> <div class="docstring"><pre>Convenience function to construct a server.

This function will compose a server with a mixing graph, ready for
use.

DEVICE is a hint passed on to the output drain to select a specific
output device. Usually a string of some kind, though the semantics are
drain-dependent.

LATENCY (in seconds) is used to compute the standard buffer
size. Setting this to 0.02 or so should be safe.

OUTPUT-CHANNELS is the number of channels of the internal mixing
hierarchy. Note that the drain may still perform conversion to upmix
or downmix regardless of this setting.

EFFECTS is a list of effects specs:

  EFFECT ::= class-designator | (class-name initarg*)

Each of the effects is applied in the same order as described and
applies to the audio stream right before output to the drain. Harmony
will automatically take care of matching up channel counts and
duplicating effects in BUNDLEs if necessary to upmix.

MIXERS is a list of mixer specs describing the mixers that are
available on the server. All of the mixers are ultimately combined
into one stream before output. The mixer specs are as follows:

  MIXER ::= name | (name class-designator [:effects (EFFECT*)] initarg*)

Effects here are as described above, applied to the output buffers of
the mixer.

Aside from the specified mixers, the server will always have a mixer
named :MASTER. It will also always have two named chains, :OUTPUT and
:SOURCES.

Returns the constructed SERVER.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:MAYBE-START-SIMPLE-SERVER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAYBE-START-SIMPLE-SERVER">MAYBE-START-SIMPLE-SERVER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument lambda-list-keyword">&amp;REST</li>    <li class="argument">INITARGS</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/simple.lisp#L99">Source</a>  </header> <div class="docstring"><pre>Constructs and starts a simple server if needed.

If *SERVER* is unbound, constructs a new one, using the passed
initargs and MAKE-SIMPLE-SERVER.
If *SERVER* is stopped, starts it.

See <a href="#FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAKE-SIMPLE-SERVER" class="xref">MAKE-SIMPLE-SERVER</a>
See MIXED:START</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:ACTIVE-P"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AACTIVE-P">ACTIVE-P</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">VOICE</li>  </ul>  </header> <div class="docstring"><pre>Returns T if the environment is playing back a source set.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AENVIRONMENT" class="xref">ENVIRONMENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:ALLOCATE-BUFFER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AALLOCATE-BUFFER">ALLOCATE-BUFFER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SERVER</li>  </ul>  </header> <div class="docstring"><pre>Retrieves an unused buffer or allocates a new one if necessary.

Note: you MUST call FREE-BUFFER on the returned buffer once it is no
longer used, or you will leak memory.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AFREE-BUFFER" class="xref">FREE-BUFFER</a>
See MIXED:BUFFER</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:ALLOCATE-UNPACKER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AALLOCATE-UNPACKER">ALLOCATE-UNPACKER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SERVER</li>  </ul>  </header> <div class="docstring"><pre>Retrieves an unused unpacker or allocates a new one if necessary.

Note: you MUST call FREE-UNPACKER on the returned instance once it is
no longer used, or you will leak memory.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AFREE-UNPACKER" class="xref">FREE-UNPACKER</a>
See MIXED:UNPACKER</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:CALL-IN-MIXING-CONTEXT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ACALL-IN-MIXING-CONTEXT">CALL-IN-MIXING-CONTEXT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FUNCTION</li>    <li class="argument">SERVER</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">SYNCHRONIZE</li>    <li class="argument">TIMEOUT</li>  </ul>  </header> <div class="docstring"><pre>Schedules FUNCTION to be called within SERVER's render thread.

If SYNCHRONIZE is T, this function will not return until the FUNCTION
has executed. In this case, the FUNCTION's return values will be
returned from this function. If SYNCHRONIZE is T and TIMEOUT is given,
the call will only block until at most TIMEOUT has passed, after which
NIL is returned.

If this function is called within the processing of the task queue,
the FUNCTION may be called immediately and synchronously.

If the server's task queue is full (which indicates the server has
shut down and is no longer processing), a WARNING is signalled, with
two restarts active: ABORT, to abort trying to execute FUNCTION, and
CONTINUE, to yield and continue trying to schedule. If the signal is
not handled, the function is not executed.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ARUN-TASK" class="xref">RUN-TASK</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:CHAIN"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ACHAIN">CHAIN</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accesses the chain of the segment.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASEGMENT" class="xref">SEGMENT</a>
See MIXED:CHAIN</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF CHAIN)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20CHAIN%29">(SETF CHAIN)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:CLEAR"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ACLEAR">CLEAR</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SERVER</li>  </ul>  </header> <div class="docstring"><pre>Removes and frees all sources from the server.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICES" class="xref">VOICES</a>
See <a href="#VARIABLE%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%2ASERVER%2A" class="xref">*SERVER*</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:CONNECT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ACONNECT">CONNECT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FROM</li>    <li class="argument">FROM-LOC</li>    <li class="argument">TO</li>    <li class="argument">TO-LOC</li>  </ul>  </header> <div class="docstring"><pre>Connects one segment to another.

FROM/TO-LOC may also be T, in which case all available ports are
connected.

May allocate buffers on the current *SERVER* to facilitate the
connection.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASEGMENT" class="xref">SEGMENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:DISCONNECT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ADISCONNECT">DISCONNECT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FROM</li>    <li class="argument">FROM-LOC</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">DIRECTION</li>  </ul>  </header> <div class="docstring"><pre>Disconnects a segment's port.

DIRECTION designates whether an output or an input port is
disconnected. After the port has been disconnected, the associated
buffer is freed in the *SERVER*.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASEGMENT" class="xref">SEGMENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:DOWNSTREAM"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ADOWNSTREAM">DOWNSTREAM</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SEGMENT</li>    <li class="argument">INDEX</li>  </ul>  </header> <div class="docstring"><pre>Returns the segment connected downstream from this one on the specified port index.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASEGMENT" class="xref">SEGMENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:ENVIRONMENT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AENVIRONMENT">ENVIRONMENT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF ENVIRONMENT)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20ENVIRONMENT%29">(SETF ENVIRONMENT)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:FREE-BUFFER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AFREE-BUFFER">FREE-BUFFER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">BUFFER</li>    <li class="argument">SERVER</li>  </ul>  </header> <div class="docstring"><pre>Returns the buffer to the pool of free buffers, ready to be re-used.

Note that the memory held by the buffer is not freed until the server
itself is fully freed.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AALLOCATE-BUFFER" class="xref">ALLOCATE-BUFFER</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:FREE-UNPACKER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AFREE-UNPACKER">FREE-UNPACKER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">UNPACKER</li>    <li class="argument">SERVER</li>  </ul>  </header> <div class="docstring"><pre>Returns the instance to the pool of free unpackers, ready to be re-used.

Note that the memory held by the unpacker is not freed until the server
itself is fully freed.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AALLOCATE-UNPACKER" class="xref">ALLOCATE-UNPACKER</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:FROM"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AFROM">FROM</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accesses the source segment of the buffer.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ABUFFER" class="xref">BUFFER</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF FROM)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20FROM%29">(SETF FROM)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:FROM-LOCATION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AFROM-LOCATION">FROM-LOCATION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accesses the index on the source segment to which the buffer is attached.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ABUFFER" class="xref">BUFFER</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF FROM-LOCATION)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20FROM-LOCATION%29">(SETF FROM-LOCATION)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:MAKE-SOURCE-FOR"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAKE-SOURCE-FOR">MAKE-SOURCE-FOR</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SOURCE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>    <li class="argument">INITARGS</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">ON-END</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/voice.lisp#L51">Source</a>  </header> <div class="docstring"><pre>Creates a source segment for the given source type and initargs.

May be extended with further methods, but supports the following types
by default:

  PATHNAME
    The pathname is converted to a source via MAKE-SOURCE-FOR-PATH-TYPE
    by using the pathname-type as a keyword for the type.
  SOURCE
    The source is used directly.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAKE-SOURCE-FOR-PATH-TYPE" class="xref">MAKE-SOURCE-FOR-PATH-TYPE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:MAKE-SOURCE-FOR-PATH-TYPE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMAKE-SOURCE-FOR-PATH-TYPE">MAKE-SOURCE-FOR-PATH-TYPE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PATHNAME</li>    <li class="argument">TYPE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>    <li class="argument">INITARGS</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/voice.lisp#L62">Source</a>  </header> <div class="docstring"><pre>Attempts to construct a source that can handle the given type of file.

Note that this *may* load new code if quicklisp is available. However,
it is *heavily* recommended that you instead load all systems that you
require to decode source types yourself ahead of time to avoid bad
surprises on deployed systems or lag spikes during runtime.

See the cl-mixed extensions for supported formats.</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:NAME"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ANAME">NAME</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Returns the name of the segment.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASEGMENT" class="xref">SEGMENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:ON-END"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AON-END">ON-END</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accesses the function to be called when the source reaches its end.

The function should take one argument, the SOURCE.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASOURCE" class="xref">SOURCE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF ON-END)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20ON-END%29">(SETF ON-END)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:ON-FRAME-CHANGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AON-FRAME-CHANGE">ON-FRAME-CHANGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accesses the function to be called when the source's frame position changed.

The function should take two arguments, the SOURCE, and the new frame position.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASOURCE" class="xref">SOURCE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF ON-FRAME-CHANGE)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20ON-FRAME-CHANGE%29">(SETF ON-FRAME-CHANGE)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:PLAY"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3APLAY">PLAY</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SOURCE</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">NAME</li>    <li class="argument">CLASS</li>    <li class="argument">MIXER</li>    <li class="argument">EFFECTS</li>    <li class="argument">SERVER</li>    <li class="argument">REPEAT</li>    <li class="argument">REPEAT-START</li>    <li class="argument">ON-END</li>    <li class="argument">LOCATION</li>    <li class="argument">VELOCITY</li>    <li class="argument">VOLUME</li>    <li class="argument">IF-EXISTS</li>    <li class="argument">SYNCHRONIZE</li>    <li class="argument">RESET</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/simple.lisp#L111">Source</a>  </header> <div class="docstring"><pre>Plays a source back.

SOURCE may be a source segment, file, or other descriptor for an audio
source that can be coerced into a VOICE.

MIXER designates the mixer to which the resulting voice is attached to
be played back.

LOCATION and VELOCITY may be location and velocity specs to be used
with a spatial mixer.

IF-EXISTS may be

  NIL        --- NIL is returned.
  :IGNORE    --- The existing voice is returned.
  :ERROR     --- An error is signalled.
  :RESTART   --- The voice is seeked to the beginning.
  :STOP      --- The voice is stopped and returned.
  :SUPERSEDE
  :REPLACE   --- The existing voice is stopped, removed, and a new
                 voice created.

This option is only used if a source with the same name already
exists on the server. Further, only :IGNORE and NIL are used if SOURCE
is a VOICE or name for a segment.

If RESET is non-NIL, the voice is seeked to the first sample.

If a new voice has to be created, it is done via CREATE, passing along
the matching arguments.

Returns the VOICE representing the SOURCE.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICE" class="xref">VOICE</a>
See <a href="#MACRO-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AWITH-SERVER" class="xref">WITH-SERVER</a>
See <a href="#FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ACREATE" class="xref">CREATE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:REPEAT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AREPEAT">REPEAT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accesses the repeat count for the source.

May be an integer, NIL (0), or T (infinity).

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASOURCE" class="xref">SOURCE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF REPEAT)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20REPEAT%29">(SETF REPEAT)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:REPEAT-START"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AREPEAT-START">REPEAT-START</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accesses the start timestamp to which the source should be seeked on a repeat.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASOURCE" class="xref">SOURCE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF REPEAT-START)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20REPEAT-START%29">(SETF REPEAT-START)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:RUN"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ARUN">RUN</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SERVER</li>  </ul>  </header> <div class="docstring"><pre>Function called within the server's render thread.

This function should control the rendering of the audio server. To do
so, it must repeatedly call MIXDE:MIX on the server and process any
tasks that may appear on the server's processing queue.

When this function returns, the server's segment must shut down and
the server must enter the stopped state.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:RUN-TASK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ARUN-TASK">RUN-TASK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SERVER</li>    <li class="argument">TASK</li>  </ul>  </header> <div class="docstring"><pre>Function called around tasks that are executed in the server's render thread.

The TASK must be funcallable.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a>
See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ACALL-IN-MIXING-CONTEXT" class="xref">CALL-IN-MIXING-CONTEXT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:SEGMENT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASEGMENT">SEGMENT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">IDX</li>    <li class="argument">CHAIN</li>    <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">ERRORP</li>  </ul>  </header> <div class="docstring"><pre>Accesses the segment with the given name.

The index is managed via EQUAL, so both strings, symbols, etc. may be
used to name segments.

If T is used as the store, the current *SERVER* instance is used.

May also be used to search through MIXED:CHAINs.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a>
See MIXED:CHAIN
See MIXED:SEGMENT</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF SEGMENT)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20SEGMENT%29">(SETF SEGMENT)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SEGMENT</li>    <li class="argument">NAME</li>    <li class="argument">SERVER</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:SOURCE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASOURCE">SOURCE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">VOICE</li>  </ul>  </header> <div class="docstring"><pre>Returns the SOURCE segment of the voice.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICE" class="xref">VOICE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:STARTED-P"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASTARTED-P">STARTED-P</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SERVER</li>  </ul>  </header> <div class="docstring"><pre>Returns T if the server is currently alive and running.

Note that a freed server will always be stopped, but a stopped server
has not necessarily been freed.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASERVER" class="xref">SERVER</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:STATE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASTATE">STATE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accesses the current state of the environment

Must be either the name of a source set available to the environment,
or NIL.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AENVIRONMENT" class="xref">ENVIRONMENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF STATE)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20STATE%29">(SETF STATE)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:STOP"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASTOP">STOP</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">VOICE</li>  </ul>  </header> <div class="docstring"><pre>Stops the voice.

This disconnects it from the server, removes it from processing, and
clears all buffers, ensuring no leftover playback samples.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICE" class="xref">VOICE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:TO"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATO">TO</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accesses the drain segment of the buffer.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ABUFFER" class="xref">BUFFER</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF TO)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20TO%29">(SETF TO)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:TO-LOCATION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATO-LOCATION">TO-LOCATION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><pre>Accesses the index on the drain segment to which the buffer is attached.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3ABUFFER" class="xref">BUFFER</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:(SETF TO-LOCATION)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%28SETF%20TO-LOCATION%29">(SETF TO-LOCATION)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:TRACK-END"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATRACK-END">TRACK-END</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">VOICE</li>    <li class="argument">SOURCE</li>  </ul>  </header> <div class="docstring"><pre>Function called when voice ends.

See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICE" class="xref">VOICE</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:TRANSITION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ATRANSITION">TRANSITION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">THING</li>    <li class="argument">TO</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">IN</li>    <li class="argument">VOLUME</li>    <li class="argument">SYNC</li>    <li class="argument">ERROR</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/environment.lisp#L9">Source</a>  </header> <div class="docstring"><pre>Transitions an environment or segment to another state.

May be used to transition an environment to a new STATE, transition
from one music-segment to another, or transition a music-segment's
volume to a new level.

In any case, takes :IN to denote the duration of the transition in
seconds and may take :SYNC to denote whether the playheads of two
music-segments should be synchronised to match before transitioning.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AENVIRONMENT" class="xref">ENVIRONMENT</a>
See <a href="#CLASS%20ORG.SHIRAKUMO.FRAF.HARMONY%3AMUSIC-SEGMENT" class="xref">MUSIC-SEGMENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:UPSTREAM"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AUPSTREAM">UPSTREAM</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SEGMENT</li>    <li class="argument">INDEX</li>  </ul>  </header> <div class="docstring"><pre>Returns the segment connected upstream from this one on the specified port index.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ASEGMENT" class="xref">SEGMENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:VOICES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AVOICES">VOICES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SERVER</li>  </ul>  </header> <div class="docstring"><pre>Returns a fresh list of active voices playing back on the server.

If T is passed, the current *SERVER* is used.

See <a href="#VARIABLE%20ORG.SHIRAKUMO.FRAF.HARMONY%3A%2ASERVER%2A" class="xref">*SERVER*</a></pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION ORG.SHIRAKUMO.FRAF.HARMONY:WITH-SERVER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3AWITH-SERVER">WITH-SERVER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <ul class="arguments"> <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>  <li class="argument">SERVER</li>  <li class="argument lambda-list-keyword">&amp;REST</li>  <li class="argument">ARGS</li>  <li class="argument lambda-list-keyword">&amp;KEY</li>  <li class="argument">SYNCHRONIZE</li>  <li class="argument">TIMEOUT</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/harmony/blob/master/server.lisp#L254">Source</a>  </header> <div class="docstring"><pre>Shorthand macro to run BODY within the render thread.

See <a href="#GENERIC-FUNCTION%20ORG.SHIRAKUMO.FRAF.HARMONY%3ACALL-IN-MIXING-CONTEXT" class="xref">CALL-IN-MIXING-CONTEXT</a></pre></div> </article> </li> </ul> </article> </li> </ul> </section>  </article> <script>window.addEventListener("DOMContentLoaded", function(){
    var unmarkElement = function(el){
        if(el.tagName === "mark" || el.tagName === "MARK"){
            [].forEach.call(el.childNodes, function(child){
                el.parentNode.insertBefore(child, el);
            });
            el.parentNode.removeChild(el);
        }else if(el.parentNode.tagName === "mark"){
            return unmarkElement(el.parentNode);
        }
        return null;
    }

    var unmarkAll = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("mark"), unmarkElement);
    }
    
    var markElement = function(el){
        if(el.parentNode.tagName === "mark" || el.parentNode.tagName === "MARK"){
            return el.parentNode;
        } else {
            unmarkAll();
            var marked = document.createElement("mark");
            el.parentNode.insertBefore(marked, el);
            marked.appendChild(el);
            return marked;
        }
    }

    var markFragmented = function(){
        if(window.location.hash){
            var el = document.getElementById(decodeURIComponent(window.location.hash.substr(1)));
            if(el) markElement(el);
        }
    }

    var registerXrefLink = function(link){
        var el = document.getElementById(decodeURIComponent(link.getAttribute("href").substr(1)));
        if(el){
            link.addEventListener("click", function(){
                markElement(el);
            });
        }
    }

    var registerXrefLinks = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("a.xref"), registerXrefLink);
    }

    markFragmented();
    registerXrefLinks();
}); </script> </body> </html> 